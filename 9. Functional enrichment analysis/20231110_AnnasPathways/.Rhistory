pwn <- read.delim("../kegg/pwn.txt",
header=F)
pwn <- read.delim("pwn.txt",
header=F)
colnames(pwn) <- c("pw","name")
pwn$pw <- gsub("map","ko",pwn$pw)
pwn
kon <- read.delim("kon.txt",
header=F,quote="")
colnames(kon) <- c("koID","description")
pw2ko <- read.delim(file.path("ko2pw.txt"),header=F)
#pw2ko <- pw2ko[c(grep("path:map00",pw2ko[,1]),grep("path:map01",pw2ko[,1]),
#                 grep("path:ko00",pw2ko[,1]),grep("path:ko01",pw2ko[,1])),]
pw2ko[,1] <- gsub("path:","",pw2ko[,1])
pw2ko[,2] <- gsub("ko:","",pw2ko[,2])
colnames(pw2ko) <- c("pw","ko")
pw2ko$pw <- gsub("map","ko",pw2ko$pw)
pw2ko
pw2cpd <- read.delim(file.path("cmp2pw.txt"),header=F)
#pw2cpd <- pw2cpd[c(grep("path:map00",pw2cpd[,1]),grep("path:map01",pw2cpd[,1])),]
pw2cpd[,1] <- gsub("path:","",pw2cpd[,1])
pw2cpd[,2] <- gsub("cpd:","",pw2cpd[,2])
colnames(pw2cpd) <- c("pw","cpd")
pw2cpd$pw <- gsub("map","ko",pw2cpd$pw)
con <- read.delim("../kegg/cmpn.txt",
header=F)
colnames(con) <- c("cpd","name")
con <- read.delim("cmpn.txt",
header=F)
colnames(con) <- c("cpd","name")
con
ll <- read.delim("../20231002_setRankInput/lowlingSetRankInput.csv",sep=",")
ul <- read.delim("../20231002_setRankInput/uplingSetRankInput.csv",sep=",")
ll <- read.delim("../20231102_setRankInput/lowlingSetRankInput.csv",sep=",")
ul <- read.delim("../20231102_setRankInput/uplingSetRankInput.csv",sep=",")
ui <- read.delim("../20231102_setRankInput/upinterSetRankInput.csv",sep=",")
sa <- read.delim("../20231102_setRankInput/salivaSetRankInput.csv",sep=",")
to <- read.delim("../20231102_setRankInput/tongueSetRankInput.csv",sep=",")
il
ul
gs <- list(ll,ul,ui,sa,to)
names(gs) <- c("ll","ul","ui","sa","to")
gs
pws <- c("ko01051","ko01240","ko01250","ko01200","ko00562","ko00540",
"ko00670","ko00190","ko00550","ko00230","ko00240","ko02024",
"ko03018","ko00900")
pws
sapply(1:length(pws), function(x){
sapply(1:length(gs), function(y){
length(unique(pw2ko$ko[pw2ko$pw==pws[x] &
pw2ko$ko %in% gs[[y]]$geneID]))
})
})
sapply(1:length(pws), function(x){
sapply(1:length(gs), function(y){
length(unique(pw2cpd$cpd[pw2cpd$pw==pws[x] &
pw2cpd$cpd %in% gs[[y]]$geneID]))
})
})
sapply(1:length(pws), function(x){
sapply(1:length(gs), function(y){
length(unique(c(pw2cpd$cpd[pw2cpd$pw==pws[x] &
pw2cpd$cpd %in% gs[[y]]$geneID],
pw2ko$ko[pw2ko$pw==pws[x] &
pw2ko$ko %in% gs[[y]]$geneID])))
})
})
names(out) <- x$geneID[grep("^K",x$geneID)]
pathCol_KO <- lapply(gs,function(x){
out <- x$score[grep("^K",x$geneID)]
names(out) <- x$geneID[grep("^K",x$geneID)]
out
})
pathCol_cmp <- lapply(gs,function(x){
out <- x$score[grep("^C",x$geneID)]
names(out) <- x$geneID[grep("^C",x$geneID)]
out
})
for(cpw in pws[c(1,5,7:14)]){
for(i in 1:length(gs)){
pv <- pathview(pathCol_KO[[i]],
cpd.data = pathCol_cmp[[i]],
pathway.id=cpw,species="ko",
gene.idtype="KEGG",
both.dirs = list(gene = F, cpd = F),
out.suffix=names(gs)[i],
low = list(gene = "#2C7BB6", cpd = "#2C7BB6"),
mid =list(gene = "#FFFFBF", cpd = "#FFFFBF"),
high = list(gene = "#D7191C", cpd ="#D7191C"),
limit=list(gene=c(0.7,1), cpd=c(0.7,1)))
}}
library(pathview)
for(cpw in pws[c(1,5,7:14)]){
for(i in 1:length(gs)){
pv <- pathview(pathCol_KO[[i]],
cpd.data = pathCol_cmp[[i]],
pathway.id=cpw,species="ko",
gene.idtype="KEGG",
both.dirs = list(gene = F, cpd = F),
out.suffix=names(gs)[i],
low = list(gene = "#2C7BB6", cpd = "#2C7BB6"),
mid =list(gene = "#FFFFBF", cpd = "#FFFFBF"),
high = list(gene = "#D7191C", cpd ="#D7191C"),
limit=list(gene=c(0.7,1), cpd=c(0.7,1)))
}}
